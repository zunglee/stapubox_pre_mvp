ğŸ” Debugging app startup issue...
ğŸ“‹ PM2 Error Logs:
[TAILING] Tailing last 20 lines for [stapubox] process (change the value with --lines option)
/root/.pm2/logs/stapubox-error-0.log last 20 lines:
0|stapubox | ğŸ’¥ News ingestion failed: TypeError: Cannot read properties of null (reading 'buzz_digest')
0|stapubox |     at NewsIngestionService.fetchNewsFromAPI (file:///apps/stapubox-replit-app/dist/index.js:875:24)
0|stapubox |     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
0|stapubox |     at async NewsIngestionService.ingestNews (file:///apps/stapubox-replit-app/dist/index.js:926:27)
0|stapubox | You have triggered an unhandledRejection, you may have forgotten to catch a Promise rejection:
0|stapubox | Error: Could not find the build directory: /apps/stapubox-replit-app/dist/public, make sure to build the client first
0|stapubox |     at serveStatic (file:///apps/stapubox-replit-app/dist/index.js:2227:11)
0|stapubox |     at file:///apps/stapubox-replit-app/dist/index.js:2443:5
0|stapubox | (node:73095) NOTE: The AWS SDK for JavaScript (v2) is in maintenance mode.
0|stapubox |  SDK releases are limited to address critical bug fixes and security issues only.
0|stapubox | 
0|stapubox | Please migrate your code to use AWS SDK for JavaScript (v3).
0|stapubox | For more information, check the blog post at https://a.co/cUPnyil
0|stapubox | (Use `node --trace-warnings ...` to show where the warning was created)
0|stapubox | (node:73191) NOTE: The AWS SDK for JavaScript (v2) is in maintenance mode.
0|stapubox |  SDK releases are limited to address critical bug fixes and security issues only.
0|stapubox | 
0|stapubox | Please migrate your code to use AWS SDK for JavaScript (v3).
0|stapubox | For more information, check the blog post at https://a.co/cUPnyil
0|stapubox | (Use `node --trace-warnings ...` to show where the warning was created)


ğŸ“‹ PM2 Output Logs:
[TAILING] Tailing last 10 lines for [stapubox] process (change the value with --lines option)
/root/.pm2/logs/stapubox-out-0.log last 10 lines:
0|stapubox |       {
0|stapubox |         "sid": 7030918,
0|stapubox |         "buzz_id": 157,
0|stapubox |         "sname": "cricket",
0|stapubox |         "title": "Catch the Edgbaston Showdown Live: India vs England 2nd Test!",
0|stapubox |         "summary": "The thrilling India vs England 2nd Test at Edgbaston is underway, promising intense cricket action. Fans can stream live and follow every ball, every run, and every wicket as the battle for series suprem...
0|stapubox | ğŸ”„ Duplicate news item found: https://www.news18.com/cricket/india-vs-england-live-streaming-watch-2nd-test-eng-ind-edgbaston-today-online-birmingham-9413962.html
0|stapubox | ğŸ›‘ Duplicate found on page 1, stopping ingestion
0|stapubox | ğŸ‰ News ingestion completed in 0s. Total new articles: 0
0|stapubox | ğŸ“ˆ Ingestion Summary: 0 new articles added to database


ğŸ”§ PM2 Process Info:
 Describing process with id 0 - name stapubox 
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ status            â”‚ online                                  â”‚
â”‚ name              â”‚ stapubox                                â”‚
â”‚ namespace         â”‚ default                                 â”‚
â”‚ version           â”‚ 1.0.0                                   â”‚
â”‚ restarts          â”‚ 0                                       â”‚
â”‚ uptime            â”‚ 6m                                      â”‚
â”‚ script path       â”‚ /apps/stapubox-replit-app/dist/index.js â”‚
â”‚ script args       â”‚ N/A                                     â”‚
â”‚ error log path    â”‚ /root/.pm2/logs/stapubox-error-0.log    â”‚
â”‚ out log path      â”‚ /root/.pm2/logs/stapubox-out-0.log      â”‚
â”‚ pid path          â”‚ /root/.pm2/pids/stapubox-0.pid          â”‚
â”‚ interpreter       â”‚ node                                    â”‚
â”‚ interpreter args  â”‚ N/A                                     â”‚
â”‚ script id         â”‚ 0                                       â”‚
â”‚ exec cwd          â”‚ /apps/stapubox-replit-app               â”‚
â”‚ exec mode         â”‚ cluster_mode                            â”‚
â”‚ node.js version   â”‚ 20.19.3                                 â”‚
â”‚ node env          â”‚ production                              â”‚
â”‚ watch & reload    â”‚ âœ˜                                       â”‚
â”‚ unstable restarts â”‚ 0                                       â”‚
â”‚ created at        â”‚ 2025-07-03T23:55:39.532Z                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 Actions available 
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ km:heapdump            â”‚
â”‚ km:cpu:profiling:start â”‚
â”‚ km:cpu:profiling:stop  â”‚
â”‚ km:heap:sampling:start â”‚
â”‚ km:heap:sampling:stop  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 Trigger via: pm2 trigger stapubox <action_name>

 Code metrics value 
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Used Heap Size         â”‚ 28.37 MiB â”‚
â”‚ Heap Usage             â”‚ 92.03 %   â”‚
â”‚ Heap Size              â”‚ 30.83 MiB â”‚
â”‚ Event Loop Latency p95 â”‚ 1.80 ms   â”‚
â”‚ Event Loop Latency     â”‚ 0.80 ms   â”‚
â”‚ Active handles         â”‚ 1         â”‚
â”‚ Active requests        â”‚ 0         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 Divergent env variables from local env 
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ OLDPWD â”‚ /tmp â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜

 Add your own code metrics: http://bit.ly/code-metrics
 Use `pm2 logs stapubox [--lines 1000]` to display logs
 Use `pm2 env 0` to display environment variables
 Use `pm2 monit` to monitor CPU and Memory usage stapubox

ğŸ“ Checking required files:
Server file: -rw-r--r-- 1 root root 96611 Jul  3 23:52 dist/index.js
Frontend file: -rw-r--r-- 1 root root 448 Jul  3 23:55 dist/public/index.html

âš™ï¸ Environment variables in PM2 config:
module.exports = {
  apps: [{
    name: 'stapubox',
    script: 'dist/index.js',
    instances: 1,
    autorestart: true,
    watch: false,
    max_memory_restart: '1G',
    env: {
      NODE_ENV: 'production',
      PORT: 3000,
      DATABASE_URL: 'postgresql://stapubox_user:npg_dwAQM3ULCKs5@localhost:5432/stapubox_db?sslmode=disable',
      TWOFACTOR_API_KEY: '8e3fbee1-37bf-11f0-8b17-0200cd936042'
    }
  }]
};

ğŸ§ª Testing server file directly:
file:///apps/stapubox-replit-app/dist/index.js:384
  throw new Error(
        ^

Error: DATABASE_URL must be set. Did you forget to provision a database?
    at file:///apps/stapubox-replit-app/dist/index.js:384:9
    at ModuleJob.run (node:internal/modules/esm/module_job:263:25)
    at async ModuleLoader.import (node:internal/modules/esm/loader:540:24)
    at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:117:5)

Node.js v20.19.3
âŒ Server crashes when run directly

ğŸ” Checking for missing dependencies:
All dependencies installed
